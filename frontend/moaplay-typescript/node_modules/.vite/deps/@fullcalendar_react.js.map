{"version":3,"file":"@fullcalendar_react.js","names":["Component","flushSync","PureComponent"],"sources":["../../@fullcalendar/react/dist/index.js"],"sourcesContent":["import React, { Component, createRef, PureComponent } from 'react';\r\nimport { createPortal, flushSync } from 'react-dom';\r\nimport { Calendar, } from '@fullcalendar/core';\r\nimport { CustomRenderingStore, } from '@fullcalendar/core/internal';\r\nconst reactMajorVersion = parseInt(String(React.version).split('.')[0]);\r\nconst syncRenderingByDefault = reactMajorVersion < 18;\r\nexport default class FullCalendar extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.elRef = createRef();\r\n        this.isUpdating = false;\r\n        this.isUnmounting = false;\r\n        this.state = {\r\n            customRenderingMap: new Map()\r\n        };\r\n        this.requestResize = () => {\r\n            if (!this.isUnmounting) {\r\n                this.cancelResize();\r\n                this.resizeId = requestAnimationFrame(() => {\r\n                    this.doResize();\r\n                });\r\n            }\r\n        };\r\n    }\r\n    render() {\r\n        const customRenderingNodes = [];\r\n        for (const customRendering of this.state.customRenderingMap.values()) {\r\n            customRenderingNodes.push(React.createElement(CustomRenderingComponent, { key: customRendering.id, customRendering: customRendering }));\r\n        }\r\n        return (React.createElement(\"div\", { ref: this.elRef }, customRenderingNodes));\r\n    }\r\n    componentDidMount() {\r\n        // reset b/c react strict-mode calls componentWillUnmount/componentDidMount\r\n        this.isUnmounting = false;\r\n        const customRenderingStore = new CustomRenderingStore();\r\n        this.handleCustomRendering = customRenderingStore.handle.bind(customRenderingStore);\r\n        this.calendar = new Calendar(this.elRef.current, Object.assign(Object.assign({}, this.props), { handleCustomRendering: this.handleCustomRendering }));\r\n        this.calendar.render();\r\n        // attaching with .on() will cause this to fire AFTER internal preact rendering did flushSync\r\n        this.calendar.on('_beforeprint', () => {\r\n            flushSync(() => {\r\n                // our `customRenderingMap` state will be flushed at this point\r\n            });\r\n        });\r\n        let lastRequestTimestamp;\r\n        customRenderingStore.subscribe((customRenderingMap) => {\r\n            const requestTimestamp = Date.now();\r\n            const isMounting = !lastRequestTimestamp;\r\n            const runFunc = (\r\n            // don't call flushSync if React version already does sync rendering by default\r\n            // guards against fatal errors:\r\n            // https://github.com/fullcalendar/fullcalendar/issues/7448\r\n            syncRenderingByDefault ||\r\n                //\r\n                isMounting ||\r\n                this.isUpdating ||\r\n                this.isUnmounting ||\r\n                (requestTimestamp - lastRequestTimestamp) < 100 // rerendering frequently\r\n            ) ? runNow // either sync rendering (first-time or React 16/17) or async (React 18)\r\n                : flushSync; // guaranteed sync rendering\r\n            runFunc(() => {\r\n                this.setState({ customRenderingMap }, () => {\r\n                    lastRequestTimestamp = requestTimestamp;\r\n                    if (isMounting) {\r\n                        this.doResize();\r\n                    }\r\n                    else {\r\n                        this.requestResize();\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    }\r\n    componentDidUpdate() {\r\n        this.isUpdating = true;\r\n        this.calendar.resetOptions(Object.assign(Object.assign({}, this.props), { handleCustomRendering: this.handleCustomRendering }));\r\n        this.isUpdating = false;\r\n    }\r\n    componentWillUnmount() {\r\n        this.isUnmounting = true;\r\n        this.cancelResize();\r\n        this.calendar.destroy();\r\n    }\r\n    doResize() {\r\n        this.calendar.updateSize();\r\n    }\r\n    cancelResize() {\r\n        if (this.resizeId !== undefined) {\r\n            cancelAnimationFrame(this.resizeId);\r\n            this.resizeId = undefined;\r\n        }\r\n    }\r\n    getApi() {\r\n        return this.calendar;\r\n    }\r\n}\r\nFullCalendar.act = runNow; // DEPRECATED. Not leveraged anymore\r\nclass CustomRenderingComponent extends PureComponent {\r\n    render() {\r\n        const { customRendering } = this.props;\r\n        const { generatorMeta } = customRendering;\r\n        const vnode = typeof generatorMeta === 'function' ?\r\n            generatorMeta(customRendering.renderProps) :\r\n            generatorMeta;\r\n        return createPortal(vnode, customRendering.containerEl);\r\n    }\r\n}\r\n// Util\r\n// -------------------------------------------------------------------------------------------------\r\nfunction runNow(f) {\r\n    f();\r\n}\r\n//# sourceMappingURL=index.js.map"],"mappings":";;;;;;;;AAKA,IAAM,yBADoB,SAAS,oBAAa,QAAQ,CAAC,MAAM,IAAI,CAAC,GAAG,GACpB;AACnD,IAAqB,eAArB,cAA0CA,uBAAU;CAChD,cAAc;AACV,QAAM,GAAG,UAAU;AACnB,OAAK,qCAAmB;AACxB,OAAK,aAAa;AAClB,OAAK,eAAe;AACpB,OAAK,QAAQ,EACT,oCAAoB,IAAI,KAAK,EAChC;AACD,OAAK,sBAAsB;AACvB,OAAI,CAAC,KAAK,cAAc;AACpB,SAAK,cAAc;AACnB,SAAK,WAAW,4BAA4B;AACxC,UAAK,UAAU;MACjB;;;;CAId,SAAS;EACL,MAAM,uBAAuB,EAAE;AAC/B,OAAK,MAAM,mBAAmB,KAAK,MAAM,mBAAmB,QAAQ,CAChE,sBAAqB,kBAAW,cAAc,0BAA0B;GAAE,KAAK,gBAAgB;GAAqB;GAAiB,CAAC,CAAC;AAE3I,sBAAc,cAAc,OAAO,EAAE,KAAK,KAAK,OAAO,EAAE,qBAAqB;;CAEjF,oBAAoB;AAEhB,OAAK,eAAe;EACpB,MAAM,uBAAuB,IAAI,sBAAsB;AACvD,OAAK,wBAAwB,qBAAqB,OAAO,KAAK,qBAAqB;AACnF,OAAK,WAAW,IAAI,SAAS,KAAK,MAAM,SAAS,OAAO,OAAO,OAAO,OAAO,EAAE,EAAE,KAAK,MAAM,EAAE,EAAE,uBAAuB,KAAK,uBAAuB,CAAC,CAAC;AACrJ,OAAK,SAAS,QAAQ;AAEtB,OAAK,SAAS,GAAG,sBAAsB;AACnC,yCAAgB,GAEd;IACJ;EACF,IAAI;AACJ,uBAAqB,WAAW,uBAAuB;GACnD,MAAM,mBAAmB,KAAK,KAAK;GACnC,MAAM,aAAa,CAAC;AAapB,IARA,0BAEI,cACA,KAAK,cACL,KAAK,gBACJ,mBAAmB,uBAAwB,MAC5C,SACEC,kCACQ;AACV,SAAK,SAAS,EAAE,oBAAoB,QAAQ;AACxC,4BAAuB;AACvB,SAAI,WACA,MAAK,UAAU;SAGf,MAAK,eAAe;MAE1B;KACJ;IACJ;;CAEN,qBAAqB;AACjB,OAAK,aAAa;AAClB,OAAK,SAAS,aAAa,OAAO,OAAO,OAAO,OAAO,EAAE,EAAE,KAAK,MAAM,EAAE,EAAE,uBAAuB,KAAK,uBAAuB,CAAC,CAAC;AAC/H,OAAK,aAAa;;CAEtB,uBAAuB;AACnB,OAAK,eAAe;AACpB,OAAK,cAAc;AACnB,OAAK,SAAS,SAAS;;CAE3B,WAAW;AACP,OAAK,SAAS,YAAY;;CAE9B,eAAe;AACX,MAAI,KAAK,aAAa,QAAW;AAC7B,wBAAqB,KAAK,SAAS;AACnC,QAAK,WAAW;;;CAGxB,SAAS;AACL,SAAO,KAAK;;;AAGpB,aAAa,MAAM;AACnB,IAAM,2BAAN,cAAuCC,2BAAc;CACjD,SAAS;EACL,MAAM,EAAE,oBAAoB,KAAK;EACjC,MAAM,EAAE,kBAAkB;EAC1B,MAAM,QAAQ,OAAO,kBAAkB,aACnC,cAAc,gBAAgB,YAAY,GAC1C;AACJ,4CAAoB,OAAO,gBAAgB,YAAY;;;AAK/D,SAAS,OAAO,GAAG;AACf,IAAG"}