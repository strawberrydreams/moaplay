{"version":3,"file":"@fullcalendar_react.js","names":["Component","flushSync","PureComponent"],"sources":["../../@fullcalendar/react/dist/index.js"],"sourcesContent":["import React, { Component, createRef, PureComponent } from 'react';\nimport { createPortal, flushSync } from 'react-dom';\nimport { Calendar, } from '@fullcalendar/core';\nimport { CustomRenderingStore, } from '@fullcalendar/core/internal';\nconst reactMajorVersion = parseInt(String(React.version).split('.')[0]);\nconst syncRenderingByDefault = reactMajorVersion < 18;\nexport default class FullCalendar extends Component {\n    constructor() {\n        super(...arguments);\n        this.elRef = createRef();\n        this.isUpdating = false;\n        this.isUnmounting = false;\n        this.state = {\n            customRenderingMap: new Map()\n        };\n        this.requestResize = () => {\n            if (!this.isUnmounting) {\n                this.cancelResize();\n                this.resizeId = requestAnimationFrame(() => {\n                    this.doResize();\n                });\n            }\n        };\n    }\n    render() {\n        const customRenderingNodes = [];\n        for (const customRendering of this.state.customRenderingMap.values()) {\n            customRenderingNodes.push(React.createElement(CustomRenderingComponent, { key: customRendering.id, customRendering: customRendering }));\n        }\n        return (React.createElement(\"div\", { ref: this.elRef }, customRenderingNodes));\n    }\n    componentDidMount() {\n        // reset b/c react strict-mode calls componentWillUnmount/componentDidMount\n        this.isUnmounting = false;\n        const customRenderingStore = new CustomRenderingStore();\n        this.handleCustomRendering = customRenderingStore.handle.bind(customRenderingStore);\n        this.calendar = new Calendar(this.elRef.current, Object.assign(Object.assign({}, this.props), { handleCustomRendering: this.handleCustomRendering }));\n        this.calendar.render();\n        // attaching with .on() will cause this to fire AFTER internal preact rendering did flushSync\n        this.calendar.on('_beforeprint', () => {\n            flushSync(() => {\n                // our `customRenderingMap` state will be flushed at this point\n            });\n        });\n        let lastRequestTimestamp;\n        customRenderingStore.subscribe((customRenderingMap) => {\n            const requestTimestamp = Date.now();\n            const isMounting = !lastRequestTimestamp;\n            const runFunc = (\n            // don't call flushSync if React version already does sync rendering by default\n            // guards against fatal errors:\n            // https://github.com/fullcalendar/fullcalendar/issues/7448\n            syncRenderingByDefault ||\n                //\n                isMounting ||\n                this.isUpdating ||\n                this.isUnmounting ||\n                (requestTimestamp - lastRequestTimestamp) < 100 // rerendering frequently\n            ) ? runNow // either sync rendering (first-time or React 16/17) or async (React 18)\n                : flushSync; // guaranteed sync rendering\n            runFunc(() => {\n                this.setState({ customRenderingMap }, () => {\n                    lastRequestTimestamp = requestTimestamp;\n                    if (isMounting) {\n                        this.doResize();\n                    }\n                    else {\n                        this.requestResize();\n                    }\n                });\n            });\n        });\n    }\n    componentDidUpdate() {\n        this.isUpdating = true;\n        this.calendar.resetOptions(Object.assign(Object.assign({}, this.props), { handleCustomRendering: this.handleCustomRendering }));\n        this.isUpdating = false;\n    }\n    componentWillUnmount() {\n        this.isUnmounting = true;\n        this.cancelResize();\n        this.calendar.destroy();\n    }\n    doResize() {\n        this.calendar.updateSize();\n    }\n    cancelResize() {\n        if (this.resizeId !== undefined) {\n            cancelAnimationFrame(this.resizeId);\n            this.resizeId = undefined;\n        }\n    }\n    getApi() {\n        return this.calendar;\n    }\n}\nFullCalendar.act = runNow; // DEPRECATED. Not leveraged anymore\nclass CustomRenderingComponent extends PureComponent {\n    render() {\n        const { customRendering } = this.props;\n        const { generatorMeta } = customRendering;\n        const vnode = typeof generatorMeta === 'function' ?\n            generatorMeta(customRendering.renderProps) :\n            generatorMeta;\n        return createPortal(vnode, customRendering.containerEl);\n    }\n}\n// Util\n// -------------------------------------------------------------------------------------------------\nfunction runNow(f) {\n    f();\n}\n//# sourceMappingURL=index.js.map"],"mappings":";;;;;;;;AAKA,IAAM,yBADoB,SAAS,oBAAa,QAAQ,CAAC,MAAM,IAAI,CAAC,GAAG,GACpB;AACnD,IAAqB,eAArB,cAA0CA,uBAAU;CAChD,cAAc;AACV,QAAM,GAAG,UAAU;AACnB,OAAK,qCAAmB;AACxB,OAAK,aAAa;AAClB,OAAK,eAAe;AACpB,OAAK,QAAQ,EACT,oCAAoB,IAAI,KAAK,EAChC;AACD,OAAK,sBAAsB;AACvB,OAAI,CAAC,KAAK,cAAc;AACpB,SAAK,cAAc;AACnB,SAAK,WAAW,4BAA4B;AACxC,UAAK,UAAU;MACjB;;;;CAId,SAAS;EACL,MAAM,uBAAuB,EAAE;AAC/B,OAAK,MAAM,mBAAmB,KAAK,MAAM,mBAAmB,QAAQ,CAChE,sBAAqB,kBAAW,cAAc,0BAA0B;GAAE,KAAK,gBAAgB;GAAqB;GAAiB,CAAC,CAAC;AAE3I,sBAAc,cAAc,OAAO,EAAE,KAAK,KAAK,OAAO,EAAE,qBAAqB;;CAEjF,oBAAoB;AAEhB,OAAK,eAAe;EACpB,MAAM,uBAAuB,IAAI,sBAAsB;AACvD,OAAK,wBAAwB,qBAAqB,OAAO,KAAK,qBAAqB;AACnF,OAAK,WAAW,IAAI,SAAS,KAAK,MAAM,SAAS,OAAO,OAAO,OAAO,OAAO,EAAE,EAAE,KAAK,MAAM,EAAE,EAAE,uBAAuB,KAAK,uBAAuB,CAAC,CAAC;AACrJ,OAAK,SAAS,QAAQ;AAEtB,OAAK,SAAS,GAAG,sBAAsB;AACnC,yCAAgB,GAEd;IACJ;EACF,IAAI;AACJ,uBAAqB,WAAW,uBAAuB;GACnD,MAAM,mBAAmB,KAAK,KAAK;GACnC,MAAM,aAAa,CAAC;AAapB,IARA,0BAEI,cACA,KAAK,cACL,KAAK,gBACJ,mBAAmB,uBAAwB,MAC5C,SACEC,kCACQ;AACV,SAAK,SAAS,EAAE,oBAAoB,QAAQ;AACxC,4BAAuB;AACvB,SAAI,WACA,MAAK,UAAU;SAGf,MAAK,eAAe;MAE1B;KACJ;IACJ;;CAEN,qBAAqB;AACjB,OAAK,aAAa;AAClB,OAAK,SAAS,aAAa,OAAO,OAAO,OAAO,OAAO,EAAE,EAAE,KAAK,MAAM,EAAE,EAAE,uBAAuB,KAAK,uBAAuB,CAAC,CAAC;AAC/H,OAAK,aAAa;;CAEtB,uBAAuB;AACnB,OAAK,eAAe;AACpB,OAAK,cAAc;AACnB,OAAK,SAAS,SAAS;;CAE3B,WAAW;AACP,OAAK,SAAS,YAAY;;CAE9B,eAAe;AACX,MAAI,KAAK,aAAa,QAAW;AAC7B,wBAAqB,KAAK,SAAS;AACnC,QAAK,WAAW;;;CAGxB,SAAS;AACL,SAAO,KAAK;;;AAGpB,aAAa,MAAM;AACnB,IAAM,2BAAN,cAAuCC,2BAAc;CACjD,SAAS;EACL,MAAM,EAAE,oBAAoB,KAAK;EACjC,MAAM,EAAE,kBAAkB;EAC1B,MAAM,QAAQ,OAAO,kBAAkB,aACnC,cAAc,gBAAgB,YAAY,GAC1C;AACJ,4CAAoB,OAAO,gBAAgB,YAAY;;;AAK/D,SAAS,OAAO,GAAG;AACf,IAAG"}